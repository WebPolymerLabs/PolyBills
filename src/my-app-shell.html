<link rel="import" href="../bower_components/polymer/polymer.html">

<link rel="import" href="../bower_components/polymerfire/firebase.html">
<link rel="import" href="../bower_components/polymerfire/firebase-app.html">

<link rel="import" href="./my-core-behaviors/my-element-loader-behavior.html">

<link rel="import" href="./my-app-welcome/my-app-welcome.html">
<!--<link rel="import" href="./my-app-main/my-app-main.html">-->

<dom-module id="my-app-shell">
  <template>
    <style>
    </style>

    <firebase-app auth-domain="polybills-d5b9f.firebaseapp.com"
      database-url="https://polybills-d5b9f.firebaseio.com"
      storage-bucket="polybills-d5b9f.appspot.com"
      api-key="AIzaSyDuczkKiKZWNoyIJhAKVNyYcl5-K9V7kjo",
      messaging-sender-id="643320248368">
    </firebase-app>

    <my-app-main user="[[user]]" on-sign-out-request="_onSignOutRequest">
      <my-app-welcome id="appWelcome" user="{{user}}" on-signin-response="_onSigninResponse"></my-app-welcome>
    </my-app-main>
  </template>

  <script>
    window.PolyBills = window.PolyBills || {};
    window.PolyBills.AppContext = window.PolyBills.AppContext || {};
    Polymer({
      is: 'my-app-shell',

      behaviors: [
        PolyBills.ElementLoaderBehavior
      ],

      attached: function () {
        this.$.appWelcome.signIn();
      },

      _onSigninResponse: function (e) {
        if (e.detail) {
          this.auth = e.detail.auth;
          this.resolveLoadElement('my-app-main/my-app-main.html');
        }
      },

      _onSignOutRequest: function () {
        this.auth.signOut().then(function () {
          location.reload(true);
        });
      },
    });
  </script>
</dom-module>
